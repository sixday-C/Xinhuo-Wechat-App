{"bsonType":"object","required":["phone","username"],"permission":{"read":"doc.user_id == auth.uid || 'admin' in auth.role","create":true,"update":"doc.user_id == auth.uid || 'admin' in auth.role","delete":"'admin' in auth.role"},"properties":{"_id":{"description":"自动生成的用户ID"},"username":{"bsonType":"string","title":"用户名","minLength":2,"maxLength":20,"label":"用户名","errorMessage":{"required":"{label}必填","minLength":"{label}长度不能少于{minLength}位","maxLength":"{label}长度不能大于{maxLength}位"}},"phone":{"bsonType":"string","title":"手机号","pattern":"^1[3-9]\\d{9}$","label":"手机号","errorMessage":{"required":"{label}必填","pattern":"{label}格式不正确"}},"avatar":{"bsonType":"string","title":"头像","format":"url","label":"头像URL"},"real_name":{"bsonType":"string","title":"真实姓名","maxLength":20,"label":"真实姓名"},"gender":{"bsonType":"int","title":"性别","enum":[0,1,2],"enumText":["未知","男","女"],"default":0,"label":"性别"},"community_id":{"bsonType":"string","title":"所属社区ID","foreignKey":"community._id","description":"用户所属社区"},"room_number":{"bsonType":"string","title":"房间号","description":"用户房间\/门牌号","label":"房间号"},"role":{"bsonType":"array","title":"用户角色","items":{"bsonType":"string","enum":["resident","property","admin"]},"default":["resident"],"description":"用户角色：resident居民、property物业、admin管理员"},"status":{"bsonType":"int","title":"账户状态","enum":[0,1,2],"enumText":["正常","禁用","待审核"],"default":0,"label":"状态"},"register_time":{"bsonType":"timestamp","title":"注册时间","defaultValue":{"$env":"now"},"forceDefaultValue":true},"last_login_time":{"bsonType":"timestamp","title":"最后登录时间"},"last_login_ip":{"bsonType":"string","title":"最后登录IP"}},"indexes":[{"name":"idx_phone_unique","fields":["phone"],"unique":true},{"name":"idx_community_room","fields":["community_id","room_number"]},{"name":"idx_status","fields":["status"]}]}